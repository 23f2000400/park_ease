
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
<div class="find-parking-container container py-5">

  <!-- Search Form -->
  <div class="row justify-content-center mb-5">
    <div class="col-md-6">
      <div class="card shadow-sm">
        <div class="card-body p-4">
          <h3 class="text-center mb-4">Find Parking</h3>
          <form @submit.prevent="findParking">
            <div class="mb-3">
              <label for="city" class="form-label">Select City</label>
              <select
                id="city"
                class="form-select"
                v-model="selectedCity"
                @change="findParking"
                required
              >
                <option disabled value="">-- Choose a City --</option>
                <option v-for="city in cities" :key="city" :value="city">{{ city }}</option>
              </select>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Parking Lot Results -->
  <div v-if="parkingLots.length > 0">
    <h5 class="mb-4 text-center">Available Parking in <span class="text-primary">{{ selectedCity }}</span></h5>
    <div class="row g-4">
      <div v-for="lot in parkingLots" :key="lot.id" class="col-md-4">
        <div class="card shadow border-0 h-100">
          <div class="card-body">
            <h5 class="card-title text-primary fw-bold">{{ lot.name }}</h5>
            <p class="card-text text-muted small">
                <strong>Available:</strong> {{ lot.available_spots }}<br/>
                <strong>Occupied:</strong> {{ lot.total_spots - lot.available_spots }}/{{ lot.total_spots }}<br/>
                <strong>Area:</strong> {{ lot.area }}<br/>
              <strong>Address:</strong> {{ lot.address }}, {{ lot.area }}<br/>
              <strong>Pincode:</strong> {{ lot.pincode }}<br/>
              <strong>Price:</strong> â‚¹{{ lot.price }} / hour
            </p>
            <div class="d-flex flex-wrap gap-1">
              <!-- Replace this inside the v-for for each spot -->
              <button
                v-for="spot in lot.spots"
                :key="spot.id"
                class="btn btn-sm"
                :class="spot.status === 'O' ? 'btn-danger' : 'btn-success'"
                @click="handleSpotClick(spot, lot)"
              >
                {{ spot.status === 'O' ? 'O' : 'A' }}
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- No Results Found -->
  <div v-else-if="selectedCity" class="text-center mt-4">
    <p class="text-muted">No parking lots found in <strong>{{ selectedCity }}</strong>.</p>
  </div>

</div>

<div
  v-if="showBookingModal"
  class="modal-overlay d-flex justify-content-center align-items-center"
  style="position: fixed; top: 0; left: 0; width: 100%; height: 100%;
         background: rgba(0, 0, 0, 0.5); z-index: 1050;"
>
  <div class="bg-white p-4 rounded shadow" style="width: 400px;">
    <h5 class="text-center text-primary mb-3">Book the Parking Spot</h5>
    
    <div class="mb-2"><strong>Spot ID:</strong> {{ bookingSpot.spotId }}</div>
    <div class="mb-2"><strong>Lot ID:</strong> {{ bookingSpot.lotId }}</div>
    <div class="mb-2"><strong>User ID:</strong> {{ bookingSpot.userId }}</div>
    <div class="mb-3">
      <label for="vehicleNumber" class="form-label">Vehicle Number</label>
      <input
        id="vehicleNumber"
        v-model="bookingForm.vehicleNumber"
        class="form-control"
        placeholder="Enter vehicle number"
        required
      />
    </div>

    <div class="d-flex justify-content-end">
      <button class="btn btn-outline-secondary me-2" @click="showBookingModal = false">Cancel</button>
      <button class="btn btn-primary" @click="submitBooking">Reserve</button>
    </div>
  </div>
</div>
</body>
</html>
